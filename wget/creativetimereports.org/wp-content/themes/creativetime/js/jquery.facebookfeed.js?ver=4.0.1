/*
 * jQuery FacebookFeed Plugin
 * Requires jQuery 1.4.2
 * Requires jQuery Templates Plugin 1.0.0pre
 * Author Vladimir Shugaev <vladimir.shugaev@junvo.com>
 * Copyright Vladimir Shugaev <vladimir.shugaev@junvo.com>
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 */
(function($){
    $.fn.facebookfeed=function(options){
		var settings={
			access_token: '',
			id: '', //id of the facebook entity
			query: {},			// 
			template: '<li>${message} <a href="${link}" target="_blank">${name}</a></li>' //template for formatting each feed entry
		};
		if (options)
			$.extend(settings, options);
		var container=this;
		var requestURL='https://graph.facebook.com/'+settings.id+'/posts?access_token='+settings.access_token+'&'+$.param(settings.query)+'&callback=?'; //calback=? is required to get JSONP behaviour
		var template=$.template(null, settings.template);

		$.getJSON(requestURL, function(json){
			var messages=$.tmpl(template, json.data).appendTo(container);
			// @TODO: jp1971 Find a better way to do this
			$('#feed li').last().addClass('last'); 			
		});
		return this;
	};
})(jQuery);
